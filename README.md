# Reasoning about the antecedents of emotions: Bayesian causal inference over an intuitive theory of mind (CogSci 2022)

![Emotion Reasoning Splash Image](website/src/assets/images/splash-thumbnail.png)

**ABSTRACT** It is commonly believed that expressions visually signal rich diagnostic information to human observers. We studied how observers interpret the dynamic expressions that people spontaneously produced during a real-life high-stakes televised game. We find that human observers are remarkably poor at recovering what events elicited others' facial and bodily expressions. Beyond simple inaccuracy, people's causal reasoning exhibits systematic model-based patterns of errors. We show that latent emotion representations can explain people's reasoning about the unseen causes of expressions. A hierarchical Bayesian model simulates which events people infer to be the cause of others' expressions by comparing the emotions inferred from the expressions against the emotions people were predicted to experience in various situations. This causal model provides a close, parameter-free fit to human causal judgments, suggesting that humans interpret expressions in the context of emotion predictions generated by a causally-structured mental model of other minds.

## Project repository

This repository provides all of the raw behavioral data, analyses, and models related to the 2022 CogSci talk,

Houlihan SD, Ong D, Cusimano M, Saxe R. (2022). Reasoning about the antecedents of emotions: Bayesian causal inference over an intuitive theory of mind. In *Proceedings of the 44th Annual Conference of the Cognitive Science Society*. 

If you use this repository, the data it includes, or build on the models/analyses, please cite the paper:

```BibTeX
@inproceedings{houlihan2022emoreasoning,
  title = {Reasoning about the antecedents of emotions: {{Bayesian}} causal inference over an intuitive theory of mind},
  shorttitle = {Causal reasoning over emotions},
  booktitle = {Proceedings of the 44th {{Annual Conference}} of the {{Cognitive Science Society}}},
  author = {Houlihan, Sean Dae and Ong, Desmond and Cusimano, Maddie and Saxe, Rebecca},
  date = {2022},
  eventtitle = {{{CogSci}}}
}
```

## Demos of the stimuli

The introductory video (explaining the rules of the game) and examples of the 5 second videos of players' reactions can be viewed here: [Demos of dynamic expressions spontaneously produced by players on the Golden Balls Gameshow](https://daeh.info/p/emotionreasoning-cogsci2022/).

## Contents of the project

- `code` - models and analyses
- `datain` - the raw behavioral data collected from human observers
- `experiments` - mTurk experiments used to collect the behavioral data in `datain/`
- `figs` - figures generated by the analyses in `code/`
- `manuscript` - latex code that generates the submitted manuscript
- `website` - the project website, which includes demos of the stimuli used in `experiments/`

## Running the project

You can install the dependencies necessary to regenerate the results and figures using **1.** a [Docker](https://www.docker.com/) container **2.** a [conda](https://docs.conda.io/en/latest/) environment **3.** a pip `requirements` specification.

### 1. As a Docker container (recommended for reproducibility)

Requires [Docker](https://www.docker.com/).

```bash
### Clone git repo to the current working directory
git clone --branch main https://github.com/daeh/emotionreasoning-cogsci22.git emotionreasoning-cogsci22

### Enter the new directory
cd emotionreasoning-cogsci22

### Build Docker Image
docker build --tag emotionreasoning .

### Run Container
docker run -v `pwd`/:/projhost/ emotionreasoning
```

The container tag is arbitrary (you can replace `emotionreasoning` with a different label).

### 2. As a conda environment (recommended for customization)

You can use lock file to create an environment. Requires [conda](https://docs.conda.io/en/latest/), [conda-lock](https://github.com/conda-incubator/conda-lock), and a local installation of [TeX Live](https://www.tug.org/texlive/). 

```bash
### Clone git repo to the current working directory
git clone --branch main https://github.com/daeh/emotionreasoning-cogsci22.git emotionreasoning-cogsci22

### Enter the new directory
cd emotionreasoning-cogsci22

### Create the conda enviornment
###    Specify the path or name of the enviornment: 
###    conda-lock install [--prefix {prefix}|--name {envname}] {lockfile}
###    E.g.:
conda-lock install --name envemoreas conda-lock.yml

### Activate the conda enviornment
conda activate envemoreas

### Run the python code
python ./code/wrapper_cogsci.py --projectdir `pwd`
```

The conda enviornment name is arbitrary (you can replace `envemoreas` with a different label).

### 3. As a pip `requirements` specification

If you use a strategy other than [conda](https://docs.conda.io/en/latest/) or [Docker](https://www.docker.com/) to manage python environments, you can install the dependencies using the `requirements.txt` file located in the root directory of the project. You additionally need to have [TeX Live](https://www.tug.org/texlive/) installed locally. 

## Authors

[Sean Dae Houlihan](https://daeh.info), [Desmond Ong](https://web.stanford.edu/~dco/), [Maddie Cusimano](http://www.mit.edu/~mcusi/home.html), [Rebecca Saxe](https://saxelab.mit.edu)
